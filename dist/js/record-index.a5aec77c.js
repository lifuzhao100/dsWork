(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["record-index"],{"0a49":function(e,t,r){var n=r("9b43"),i=r("626a"),o=r("4bf8"),a=r("9def"),s=r("cd1c");e.exports=function(e,t){var r=1==e,c=2==e,l=3==e,u=4==e,f=6==e,d=5==e||f,p=t||s;return function(t,s,m){for(var y,h,b=o(t),g=i(b),v=n(s,m,3),j=a(g.length),w=0,x=r?p(t,j):c?p(t,0):void 0;j>w;w++)if((d||w in g)&&(y=g[w],h=v(y,w,b),e))if(r)x[w]=h;else if(h)switch(e){case 3:return!0;case 5:return y;case 6:return w;case 2:x.push(y)}else if(u)return!1;return f?-1:l||u?u:x}}},1169:function(e,t,r){var n=r("2d95");e.exports=Array.isArray||function(e){return"Array"==n(e)}},"2a01":function(e,t,r){"use strict";var n=r("e55f"),i=r.n(n);i.a},"386d":function(e,t,r){"use strict";var n=r("cb7c"),i=r("83a1"),o=r("5f1b");r("214f")("search",1,(function(e,t,r,a){return[function(r){var n=e(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=a(r,e,this);if(t.done)return t.value;var s=n(e),c=String(this),l=s.lastIndex;i(l,0)||(s.lastIndex=0);var u=o(s,c);return i(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},4127:function(e,t,r){"use strict";var n=r("d233"),i=r("b313"),o=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},s=Array.isArray,c=Array.prototype.push,l=function(e,t){c.apply(e,s(t)?t:[t])},u=Date.prototype.toISOString,f=i["default"],d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,format:f,formatter:i.formatters[f],indices:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},p=function(e){return"string"===typeof e||"number"===typeof e||"boolean"===typeof e||"symbol"===typeof e||"bigint"===typeof e},m=function e(t,r,i,o,a,c,u,f,m,y,h,b,g){var v=t;if("function"===typeof u?v=u(r,v):v instanceof Date?v=y(v):"comma"===i&&s(v)&&(v=v.join(",")),null===v){if(o)return c&&!b?c(r,d.encoder,g,"key"):r;v=""}if(p(v)||n.isBuffer(v)){if(c){var j=b?r:c(r,d.encoder,g,"key");return[h(j)+"="+h(c(v,d.encoder,g,"value"))]}return[h(r)+"="+h(String(v))]}var w,x=[];if("undefined"===typeof v)return x;if(s(u))w=u;else{var O=Object.keys(v);w=f?O.sort(f):O}for(var k=0;k<w.length;++k){var _=w[k];a&&null===v[_]||(s(v)?l(x,e(v[_],"function"===typeof i?i(r,_):r,i,o,a,c,u,f,m,y,h,b,g)):l(x,e(v[_],r+(m?"."+_:"["+_+"]"),i,o,a,c,u,f,m,y,h,b,g)))}return x},y=function(e){if(!e)return d;if(null!==e.encoder&&void 0!==e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=i["default"];if("undefined"!==typeof e.format){if(!o.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=i.formatters[r],a=d.filter;return("function"===typeof e.filter||s(e.filter))&&(a=e.filter),{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:"undefined"===typeof e.allowDots?d.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,delimiter:"undefined"===typeof e.delimiter?d.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:d.encode,encoder:"function"===typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:a,formatter:n,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}};e.exports=function(e,t){var r,n,i=e,o=y(t);"function"===typeof o.filter?(n=o.filter,i=n("",i)):s(o.filter)&&(n=o.filter,r=n);var c,u=[];if("object"!==typeof i||null===i)return"";c=t&&t.arrayFormat in a?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var f=a[c];r||(r=Object.keys(i)),o.sort&&r.sort(o.sort);for(var d=0;d<r.length;++d){var p=r[d];o.skipNulls&&null===i[p]||l(u,m(i[p],p,f,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.formatter,o.encodeValuesOnly,o.charset))}var h=u.join(o.delimiter),b=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),h.length>0?b+h:""}},4328:function(e,t,r){"use strict";var n=r("4127"),i=r("9e6a"),o=r("b313");e.exports={formats:o,parse:i,stringify:n}},"517b":function(e,t,r){"use strict";var n=r("8e28"),i=r.n(n);i.a},7514:function(e,t,r){"use strict";var n=r("5ca1"),i=r("0a49")(5),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),n(n.P+n.F*a,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(o)},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"8e28":function(e,t,r){},"9e6a":function(e,t,r){"use strict";var n=r("d233"),i=Object.prototype.hasOwnProperty,o=Array.isArray,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c="utf8=%26%2310003%3B",l="utf8=%E2%9C%93",u=function(e,t){var r,u={},f=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,d=t.parameterLimit===1/0?void 0:t.parameterLimit,p=f.split(t.delimiter,d),m=-1,y=t.charset;if(t.charsetSentinel)for(r=0;r<p.length;++r)0===p[r].indexOf("utf8=")&&(p[r]===l?y="utf-8":p[r]===c&&(y="iso-8859-1"),m=r,r=p.length);for(r=0;r<p.length;++r)if(r!==m){var h,b,g=p[r],v=g.indexOf("]="),j=-1===v?g.indexOf("="):v+1;-1===j?(h=t.decoder(g,a.decoder,y,"key"),b=t.strictNullHandling?null:""):(h=t.decoder(g.slice(0,j),a.decoder,y,"key"),b=t.decoder(g.slice(j+1),a.decoder,y,"value")),b&&t.interpretNumericEntities&&"iso-8859-1"===y&&(b=s(b)),b&&"string"===typeof b&&t.comma&&b.indexOf(",")>-1&&(b=b.split(",")),g.indexOf("[]=")>-1&&(b=o(b)?[b]:b),i.call(u,h)?u[h]=n.combine(u[h],b):u[h]=b}return u},f=function(e,t,r){for(var n=t,i=e.length-1;i>=0;--i){var o,a=e[i];if("[]"===a&&r.parseArrays)o=[].concat(n);else{o=r.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(s,10);r.parseArrays||""!==s?!isNaN(c)&&a!==s&&String(c)===s&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(o=[],o[c]=n):o[s]=n:o={0:n}}n=o}return n},d=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,s=r.depth>0&&o.exec(n),c=s?n.slice(0,s.index):n,l=[];if(c){if(!r.plainObjects&&i.call(Object.prototype,c)&&!r.allowPrototypes)return;l.push(c)}var u=0;while(r.depth>0&&null!==(s=a.exec(n))&&u<r.depth){if(u+=1,!r.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+n.slice(s.index)+"]"),f(l,t,r)}},p=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!==typeof e.decoder)throw new TypeError("Decoder has to be a function.");if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t="undefined"===typeof e.charset?a.charset:e.charset;return{allowDots:"undefined"===typeof e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"===typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,arrayLimit:"number"===typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"===typeof e.comma?e.comma:a.comma,decoder:"function"===typeof e.decoder?e.decoder:a.decoder,delimiter:"string"===typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"===typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"===typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"===typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"===typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}};e.exports=function(e,t){var r=p(t);if(""===e||null===e||"undefined"===typeof e)return r.plainObjects?Object.create(null):{};for(var i="string"===typeof e?u(e,r):e,o=r.plainObjects?Object.create(null):{},a=Object.keys(i),s=0;s<a.length;++s){var c=a[s],l=d(c,i[c],r);o=n.merge(o,l,r)}return n.compact(o)}},a481:function(e,t,r){"use strict";var n=r("cb7c"),i=r("4bf8"),o=r("9def"),a=r("4588"),s=r("0390"),c=r("5f1b"),l=Math.max,u=Math.min,f=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};r("214f")("replace",2,(function(e,t,r,y){return[function(n,i){var o=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},function(e,t){var i=y(r,e,this,t);if(i.done)return i.value;var f=n(e),d=String(this),p="function"===typeof t;p||(t=String(t));var b=f.global;if(b){var g=f.unicode;f.lastIndex=0}var v=[];while(1){var j=c(f,d);if(null===j)break;if(v.push(j),!b)break;var w=String(j[0]);""===w&&(f.lastIndex=s(d,o(f.lastIndex),g))}for(var x="",O=0,k=0;k<v.length;k++){j=v[k];for(var _=String(j[0]),S=l(u(a(j.index),d.length),0),D=[],N=1;N<j.length;N++)D.push(m(j[N]));var A=j.groups;if(p){var P=[_].concat(D,S,d);void 0!==A&&P.push(A);var $=String(t.apply(void 0,P))}else $=h(_,d,S,D,A,t);S>=O&&(x+=d.slice(O,S)+$,O=S+_.length)}return x+d.slice(O)}];function h(e,t,n,o,a,s){var c=n+e.length,l=o.length,u=p;return void 0!==a&&(a=i(a),u=d),r.call(s,u,(function(r,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(c);case"<":s=a[i.slice(1,-1)];break;default:var u=+i;if(0===u)return r;if(u>l){var d=f(u/10);return 0===d?r:d<=l?void 0===o[d-1]?i.charAt(1):o[d-1]+i.charAt(1):r}s=o[u-1]}return void 0===s?"":s}))}}))},b313:function(e,t,r){"use strict";var n=String.prototype.replace,i=/%20/g,o=r("d233"),a={RFC1738:"RFC1738",RFC3986:"RFC3986"};e.exports=o.assign({default:a.RFC3986,formatters:{RFC1738:function(e){return n.call(e,i,"+")},RFC3986:function(e){return String(e)}}},a)},caae:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{id:"page-record"}},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.openAddDialog}},[e._v("\n\t\t登记工时\n\t")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},e._l(e.columns,(function(e){return r("el-table-column",{key:e.key,attrs:{prop:e.classes,label:e.label,"show-overflow-tooltip":e.overflow}})})),1),r("el-pagination",{attrs:{background:"","hide-on-single-page":!0,layout:"prev, pager, next",total:e.total,"page-size":e.size,"current-page":e.form.page},on:{"update:pageSize":function(t){e.size=t},"update:page-size":function(t){e.size=t},"update:currentPage":function(t){return e.$set(e.form,"page",t)},"update:current-page":function(t){return e.$set(e.form,"page",t)},"current-change":e.search}}),r("record-add")],1)},i=[],o=(r("ac6a"),r("a481"),r("96cf"),r("3b8d")),a=(r("386d"),r("db82")),s=r.n(a),c=r("02cc"),l=r.n(c),u=r("358c"),f=r("4328"),d=r.n(f),p=r("e5c0"),m={name:"index",components:{recordAdd:p["a"]},data:function(){return{columns:[{label:"项目",classes:"project",key:"project"},{label:"日期",classes:"spent_on",key:"spent_on"},{label:"用户",classes:"user",key:"user"},{label:"活动",classes:"activity",key:"activity"},{label:"问题",classes:"issue",key:"issue"},{label:"注释",classes:"comments",key:"comments",overflow:!0},{label:"小时",classes:"hours",key:"hours"},{label:"执行部门",classes:"project_cf_18",key:"project.cf_18",overflow:!0}],form:{page:1},tableData:[],size:10,total:0,loading:!1}},computed:{params:function(){var e=this.form.page;return{c:this.columns.map((function(e){return e.key})),f:["user_id",""],group_by:"",op:{user_id:"="},page:e,set_filter:1,sort:"spent_on:desc",t:["hours",""],utf8:"✓",v:{user_id:["me"]}}}},mounted:function(){this.search(1)},methods:{search:function(e){this.form.page=e,this.getList()},getList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.loading=!0,s.a.get(u["e"]).query(d.a.stringify(this.params,{arrayFormat:"brackets"})).end((function(e,r){t.loading=!1;var n=[],i=0,o=10;if(!e){var a=l.a.load(r.text),s=a(".pagination");a(".items",s).text().replace(/[0-9]+(?=\))/,(function(e){i=parseInt(e)})),o=a(".selected",s).text(),a(".time-entry",".time-entries tbody").each((function(e,r){var i={};t.columns.forEach((function(e){var t=a("."+e.classes,r);i[e.classes]=t.text()})),n.push(i)}))}t.tableData=n,t.total=parseInt(i),t.size=parseInt(o)}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),openAddDialog:function(){this.$router.push({path:"/record/add"})}}},y=m,h=(r("2a01"),r("2877")),b=Object(h["a"])(y,n,i,!1,null,null,null);t["default"]=b.exports},cd1c:function(e,t,r){var n=r("e853");e.exports=function(e,t){return new(n(e))(t)}},d233:function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,i=Array.isArray,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e){while(e.length>1){var t=e.pop(),r=t.obj[t.prop];if(i(r)){for(var n=[],o=0;o<r.length;++o)"undefined"!==typeof r[o]&&n.push(r[o]);t.obj[t.prop]=n}}},s=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)"undefined"!==typeof e[n]&&(r[n]=e[n]);return r},c=function e(t,r,o){if(!r)return t;if("object"!==typeof r){if(i(t))t.push(r);else{if(!t||"object"!==typeof t)return[t,r];(o&&(o.plainObjects||o.allowPrototypes)||!n.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!==typeof t)return[t].concat(r);var a=t;return i(t)&&!i(r)&&(a=s(t,o)),i(t)&&i(r)?(r.forEach((function(r,i){if(n.call(t,i)){var a=t[i];a&&"object"===typeof a&&r&&"object"===typeof r?t[i]=e(a,r,o):t.push(r)}else t[i]=r})),t):Object.keys(r).reduce((function(t,i){var a=r[i];return n.call(t,i)?t[i]=e(t[i],a,o):t[i]=a,t}),a)},l=function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},u=function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(i){return n}},f=function(e,t,r){if(0===e.length)return e;var n=e;if("symbol"===typeof e?n=Symbol.prototype.toString.call(e):"string"!==typeof e&&(n=String(e)),"iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var i="",a=0;a<n.length;++a){var s=n.charCodeAt(a);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?i+=n.charAt(a):s<128?i+=o[s]:s<2048?i+=o[192|s>>6]+o[128|63&s]:s<55296||s>=57344?i+=o[224|s>>12]+o[128|s>>6&63]+o[128|63&s]:(a+=1,s=65536+((1023&s)<<10|1023&n.charCodeAt(a)),i+=o[240|s>>18]+o[128|s>>12&63]+o[128|s>>6&63]+o[128|63&s])}return i},d=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],o=i.obj[i.prop],s=Object.keys(o),c=0;c<s.length;++c){var l=s[c],u=o[l];"object"===typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:o,prop:l}),r.push(u))}return a(t),e},p=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},m=function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},y=function(e,t){return[].concat(e,t)};e.exports={arrayToObject:s,assign:l,combine:y,compact:d,decode:u,encode:f,isBuffer:m,isRegExp:p,merge:c}},e55f:function(e,t,r){},e5c0:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{id:"record-add",title:"登记工时",visible:e.dialogVisible,width:"65%",beforeClose:e.beforeClose,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"60px"}},[r("el-form-item",{attrs:{label:"项目",prop:"project_id",rules:[{required:!0,message:"请选择项目"}]}},[r("el-select",{attrs:{filterable:!0,size:"small",placeholder:"请选择项目"},on:{change:e.selectProject},model:{value:e.form.project_id,callback:function(t){e.$set(e.form,"project_id",t)},expression:"form.project_id"}},e._l(e.projectList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"问题"}},[r("el-input",{attrs:{size:"small",placeholder:"请输入问题"},model:{value:e.form.issue_id,callback:function(t){e.$set(e.form,"issue_id",t)},expression:"form.issue_id"}})],1),e.isNested?e._e():r("el-form-item",{attrs:{label:"日期",prop:"spent_on",rules:[{required:!0,message:"请选择日期"}]}},[r("el-date-picker",{attrs:{clearable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small",type:"date",placeholder:"请选择日期"},model:{value:e.form.spent_on,callback:function(t){e.$set(e.form,"spent_on",t)},expression:"form.spent_on"}})],1),r("el-form-item",{attrs:{label:"小时",prop:"hours",rules:[{required:!0,message:"请输入小时"}]}},[r("el-input-number",{attrs:{size:"small",min:.1,max:24,step:.5,placeholder:"小时"},model:{value:e.form.hours,callback:function(t){e.$set(e.form,"hours",t)},expression:"form.hours"}})],1),r("el-form-item",{attrs:{label:"注释"}},[r("el-input",{attrs:{size:"small",placeholder:"请输入注释"},model:{value:e.form.comments,callback:function(t){e.$set(e.form,"comments",t)},expression:"form.comments"}})],1),r("el-form-item",{attrs:{label:"活动",prop:"activity_id",rules:[{required:!0,message:"请选择活动"}]}},[r("el-select",{attrs:{size:"small",placeholder:"请选择活动"},on:{change:e.selectActivity},model:{value:e.form.activity_id,callback:function(t){e.$set(e.form,"activity_id",t)},expression:"form.activity_id"}},e._l(e.activitiesList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n\t    取消\n    ")]),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addTimeEntry}},[e._v("\n\t    确定\n    ")])],1)],1)},i=[],o=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),a=(r("7514"),r("a481"),r("96cf"),r("3b8d")),s=r("5a0c"),c=r.n(s),l=r("5c96");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={name:"add",props:{isNested:{type:Boolean,default:!1}},data:function(){return{dialogVisible:!1,projectList:[],activitiesList:[],token:"",form:this.getDefaultForm()}},computed:{params:function(){return{utf8:"✓",back_url:"",commit:"创建",time_entry:this.form}}},watch:{$route:{immediate:!0,deep:!0,handler:function(e){"add"===e.params.recordOperate&&(this.dialogVisible=!0)}},dialogVisible:{immediate:!0,handler:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r,n,i,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return this.toggleLoading(!0,"loading..."),e.next=5,this.$api.getTimeEntriesNew();case 5:if(r=e.sent,n=r.success,i=r.token,o=r.projectList,a=r.activitiesList,this.toggleLoading(!1),n){e.next=13;break}return e.abrupt("return");case 13:this.token=i,this.projectList=o,this.activitiesList=a;case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},mounted:function(){var e=this,t=["project_id","activity_id"];this.$storage.getItems(t.map((function(e){return{key:e,defaultValue:""}}))).then((function(r){t.forEach((function(t){e.form[t]=r[t]}))})),this.$bus.$on("dialog_record-add",(function(){e.dialogVisible=!0}))},methods:{getDefaultForm:function(){return{project_id:"",issue_id:"",spent_on:c()().format("YYYY-MM-DD"),hours:8,comments:"",activity_id:""}},beforeClose:function(){var e=this.$route.params;this.dialogVisible=!1,this.form=this.getDefaultForm(),"add"===e.recordOperate&&this.$router.replace({path:"/record"})},selectProject:function(e){this.$storage.setItem("project_id",e)},selectActivity:function(e){this.$storage.setItem("activity_id",e)},addTimeEntry:function(){var e=this;this.$refs.form.validate(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var n,i,o,a,s,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:if(!e.isNested){t.next=9;break}n=e.form,i=e.projectList.find((function(e){return e.value===n.project_id})).label,o=e.activitiesList.find((function(e){return e.value===n.activity_id})).label,e.$emit("submit",{projectName:i,project_id:n.project_id,issue_id:n.issue_id,hours:n.hours,comments:n.comments,activityName:o,activity_id:n.activity_id}),e.beforeClose(),t.next=18;break;case 9:return a=f({},e.params,{authenticity_token:e.token}),e.toggleLoading(!0,"提交中..."),t.next=13,e.$api.addTimeEntry(a);case 13:s=t.sent,c=s.success,l=s.message,e.toggleLoading(!1),c?(e.$message({type:"success",message:"登记成功"}),e.beforeClose()):e.$message({type:"error",message:"登记工时失败："+l});case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},toggleLoading:function(e,t){e?this.loadingInstance=l["Loading"].service({target:"#record-add .el-dialog",text:t}):this.loadingInstance&&this.loadingInstance.close()}}},p=d,m=(r("517b"),r("2877")),y=Object(m["a"])(p,n,i,!1,null,null,null);t["a"]=y.exports},e853:function(e,t,r){var n=r("d3f4"),i=r("1169"),o=r("2b4c")("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&(t=t[o],null===t&&(t=void 0))),void 0===t?Array:t}}}]);
//# sourceMappingURL=record-index.a5aec77c.js.map