(function(e){function t(t){for(var r,a,u=t[0],c=t[1],s=t[2],l=0,d=[];l<u.length;l++)a=u[l],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);f&&f(t);while(d.length)d.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var u=n[a];0!==i[u]&&(r=!1)}r&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},i={app:0},o=[];function u(e){return c.p+"js/"+({"email-index":"email-index","login-index":"login-index","record-index":"record-index","schedule-index":"schedule-index"}[e]||e)+"."+{"email-index":"59e752b2","login-index":"fdd58929","record-index":"a5aec77c","schedule-index":"96967fdf"}[e]+".js"}function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"email-index":1,"login-index":1,"record-index":1,"schedule-index":1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=new Promise((function(t,n){for(var r="css/"+({"email-index":"email-index","login-index":"login-index","record-index":"record-index","schedule-index":"schedule-index"}[e]||e)+"."+{"email-index":"0e433876","login-index":"3fec542b","record-index":"8b5fefc0","schedule-index":"15bb51b2"}[e]+".css",i=c.p+r,o=document.getElementsByTagName("link"),u=0;u<o.length;u++){var s=o[u],l=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(l===r||l===i))return t()}var d=document.getElementsByTagName("style");for(u=0;u<d.length;u++){s=d[u],l=s.getAttribute("data-href");if(l===r||l===i)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var r=t&&t.target&&t.target.src||i,o=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=r,delete a[e],f.parentNode.removeChild(f),n(o)},f.href=i;var p=document.getElementsByTagName("head")[0];p.appendChild(f)})).then((function(){a[e]=0})));var r=i[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise((function(t,n){r=i[e]=[t,n]}));t.push(r[2]=o);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=u(e);var d=new Error;s=function(t){l.onerror=l.onload=null,clearTimeout(f);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",d.name="ChunkLoadError",d.type=r,d.request=a,n[1](d)}i[e]=void 0}};var f=setTimeout((function(){s({type:"timeout",target:l})}),12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var f=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},2:function(e,t){},3:function(e,t){},"358c":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c}));var r="http://39.98.57.31:8585/",a=r+"redmine/login",i=r+"redmine/time_entries",o=r+"redmine/time_entries/new",u=r+"redmine/time_entries",c=[{label:"弹窗通知",value:"notification"},{label:"自动登记",value:"addTimeEntry"}]},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("96cf");var r=n("3b8d"),a=(n("cadf"),n("551c"),n("f751"),n("097d"),n("2b0e")),i=n("5c96"),o=n.n(i),u=(n("0fae"),n("2f62")),c={loginLoading:!1,isLogged:!1,user:{},allScheduleList:[]},s={updateLoginLoading:function(e,t){e.loginLoading=t},updateIsLogged:function(e,t){e.isLogged=t},updateUser:function(e,t){e.user=t},updateAllScheduleList:function(e,t){e.allScheduleList=t}},l={scheduleList:function(e){var t=e.user,n=e.allScheduleList;return console.log("getters scheduleList"),console.log(n.filter((function(e){return e.username===t.username}))),n.filter((function(e){return e.username===t.username}))}},d=n("7618"),f=(n("456d"),n("bd86")),p=(n("ac6a"),!1);try{p=!!chrome.storage.local}catch(W){}var m={getItem:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m.getItems([t]);case 2:return n=e.sent,e.abrupt("return",n[t.key]);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),getItems:function(e){return new Promise((function(t){var n={};if(p){var r=e.map((function(e){return e.key}));chrome.storage.local.get(r,(function(r){e.forEach((function(e){var t=e.key,a=e.defaultValue;r.hasOwnProperty(t)?n[t]=r[t]:n[t]=a})),t(n)}))}else e.forEach((function(e){var t=e.key,r=e.defaultValue,a=localStorage.getItem(t);if(n[t]=r,a)try{if(r instanceof Array){var i=JSON.parse(a);i instanceof Array&&(n[t]=i)}else if(r instanceof Object){var o=JSON.parse(a);o instanceof Object&&(n[t]=o)}else n[t]=a}catch(W){}})),t(n)}))},setItem:function(e,t){var n=Object(f["a"])({},e,t);return m.setItems(n)},setItems:function(e){return new Promise((function(t){p?chrome.storage.local.set(e,(function(){t()})):(Object.keys(e).forEach((function(t){var n=e[t];n&&"object"===Object(d["a"])(n)&&(n=JSON.stringify(n)),localStorage.setItem(t,n)})),t())}))},install:function(e){e.prototype.$storage=m}},h=m,g={initStore:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,h.getItems([{key:"user",defaultValue:{}},{key:"allScheduleList",defaultValue:[]}]);case 3:r=e.sent,console.log("initStore"),console.log("storageResult",r),n("updateAllScheduleList",r.allScheduleList),n("updateUser",r.user);case 8:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),saveUser:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.next=3,h.setItems({user:n,isLogged:!0});case 3:r("updateUser",n),r("updateIsLogged",!0);case 5:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),saveScheduleItem:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dispatch,r=t.commit,e.next=3,h.getItems([{key:"user",defaultValue:{}},{key:"allScheduleList",defaultValue:[]}]);case 3:return a=e.sent,i=a.user,o=a.allScheduleList,n.username=i.username,u=o.filter((function(e){return e.username===i.username})),0===u.length?n.id=1:n.id=Math.max.apply(null,u.map((function(e){return e.id})))+1,n.id=""+n.id,o.unshift(n),e.next=12,h.setItem("allScheduleList",o);case 12:r("updateAllScheduleList",o);case 13:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),deleteScheduleItem:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r,a,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,e.next=3,h.getItems([{key:"user",defaultValue:{}},{key:"allScheduleList",defaultValue:[]}]);case 3:return a=e.sent,i=a.user,o=a.allScheduleList,o=o.filter((function(e){return e.username!==i.username||e.id!==n})),e.next=8,h.setItem("allScheduleList",o);case 8:r("updateAllScheduleList",o);case 9:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),deleteAllSchedule:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,h.getItems([{key:"user",defaultValue:{}},{key:"allScheduleList",defaultValue:[]}]);case 3:return r=e.sent,a=r.user,i=r.allScheduleList,i=i.filter((function(e){return e.username===a.username})),e.next=8,h.setItem("allScheduleList",i);case 8:n("updateAllScheduleList",i);case 9:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()};a["default"].use(u["a"]);var v=new u["a"].Store({state:c,mutations:s,getters:l,actions:g}),b=n("8c4f"),y=n("5af5"),x={getAppPath:function(e){switch(e){case"pop":return chrome.runtime.getURL("./popup.html");case"app":default:return chrome.runtime.getURL("./dsWork.html")}},getFormData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(y["a"])(e)},setTitle:function(e){var t=" | 数说故事 东半球最牛逼的大数据公司";e=e||"工时管理",e+=t,document.title=e},install:function(e){e.prototype.$fn=x}},w=x;a["default"].use(b["a"]);var k=v.state,O=new b["a"]({mode:"hash",routes:[{path:"/",redirect:"/record"},{path:"/login",component:function(){return n.e("login-index").then(n.bind(null,"9ed6"))},meta:{title:"登录"}},{path:"/record/:recordOperate?",component:function(){return n.e("record-index").then(n.bind(null,"caae"))},meta:{title:"登记列表"}},{path:"/schedule/:scheduleOperate?",component:function(){return n.e("schedule-index").then(n.bind(null,"4a5b"))},meta:{title:"定时列表"}},{path:"/email",component:function(){return n.e("email-index").then(n.bind(null,"0a6c"))},meta:{title:"邮件通知"}}]});O.beforeEach((function(e,t,n){var r=e.path,a=e.meta;w.setTitle(a.title),"/login"!==r&&(k.user.username&&k.user.password||n("/login")),n()}));var j=O,L=n("358c"),S=n("db82"),_=n.n(S),P=n("02cc"),R=n.n(P),E={},I={getToken:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,u,c,s=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},n=t.method,r=void 0===n?"get":n,a=t.url,i=t.params,o=void 0===i?{}:i,u=w.getFormData(o),c={success:!1,message:"获取Token失败",data:""},E[a]||(E[a]=new Promise((function(e){_.a[r](a).send(u).end((function(t,n){if(t)c.message=t;else{var r=R.a.load(n.text),a=r("[name=authenticity_token]");a.length>0?a.each((function(e,t){var n=r(t);c.data=n.attr("value")})):c.message="已经登录过了，无需重新登录",c.success=!0}e()}))}))),e.next=7,E[a];case 7:return delete E[a],console.log("getToken result",c),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),login:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={success:!1,message:""},e.next=3,I.getToken({url:L["b"]});case 3:if(r=e.sent,r.success){e.next=7;break}return n.message="获取token失败",e.abrupt("return",n);case 7:if(r.data){e.next=11;break}return n.success=!0,n.message=r.message,e.abrupt("return",n);case 11:return a={username:t.username,password:t.password,authenticity_token:r.data,utf8:"✓",back_url:"",login:"登录"},E[L["b"]]||(E[L["b"]]=new Promise((function(e){_.a.post(L["b"]).send(w.getFormData(a)).end((function(t,r){console.log("login"),console.log("err",t),console.log("response",r),t?n.message=t:(n.success=!0,n.message="登录成功"),e(n)}))}))),e.next=15,E[L["b"]];case 15:return n=e.sent,e.abrupt("return",n);case 17:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),getTimeEntriesNew:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.state.isLogged){e.next=3;break}return e.next=3,v.dispatch("login");case 3:return t={success:!1,token:"",projectList:[],activitiesList:[]},E[L["d"]]||(E[L["d"]]=new Promise((function(e){_.a.get(L["d"]).end((function(n,r){if(console.warn("getTimeEntriesNew"),console.log("err",n),console.log("res",r),!n){var a=R.a.load(r.text),i=a("#new_time_entry");a("#time_entry_project_id option",i).each((function(e,n){var r=a(n).attr("value"),i=a(n).text();r&&t.projectList.push({value:r,label:i})})),a("#time_entry_activity_id option",i).each((function(e,n){var r=a(n).attr("value"),i=a(n).text();r&&t.activitiesList.push({value:r,label:i})})),t.token=a("[name=authenticity_token]",i).val(),t.token&&(t.success=!0)}e()}))}))),e.next=7,E[L["d"]];case 7:return delete E[L["d"]],e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),addTimeEntry:function(e){var t={success:!1,message:""};return new Promise((function(n){_.a.post(L["c"]).send(w.getFormData(e)).end((function(e,r){e?t.message=e:t.success=!0,n(t)}))}))},install:function(e){e.prototype.$api=I}},T=I,A=new a["default"];A.install=function(e){e.prototype.$bus=A};var C=[w,A,h,T];C.forEach((function(e){a["default"].use(e)}));var N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loginLoading,expression:"loginLoading"}],attrs:{id:"app"}},[n("el-header",[n("div",{staticClass:"header"},[n("el-menu",{attrs:{"default-active":e.activeTab,router:!0,"background-color":"#001529","active-text-color":"rgb(255, 208, 75)",mode:"horizontal"}},[n("el-menu-item",{attrs:{index:"/record"}},[e._v("工时列表")]),n("el-menu-item",{attrs:{index:"/schedule"}},[e._v("定时配置")]),n("el-menu-item",{attrs:{index:"/email"}},[e._v("邮件通知")])],1),n("div",{staticClass:"user"},[n("span",{staticClass:"username",on:{click:function(t){return e.$router.push({path:"/login"})}}},[e._v(e._s(e._f("computedUser")(e.user.username)))]),n("a",{staticClass:"github",attrs:{href:"",target:"_blank"}},[n("svg",{staticClass:"octicon octicon-mark-github v-align-middle",attrs:{height:"32",viewBox:"0 0 16 16",version:"1.1",width:"32","aria-hidden":"true"}},[n("path",{attrs:{"fill-rule":"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"}})])])])],1)]),n("el-main",[n("el-page-header",{attrs:{content:e.headerContent},on:{back:e.goBack}}),n("div",{staticClass:"page-container"},[n("router-view")],1)],1),n("el-footer",[e._v("\n\t\tPowered By fuzhao\n\t")])],1)},D=[];n("8e6e"),n("28a5"),n("4917");function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Object(f["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U={name:"app",data:function(){return{activeTab:"/record",form:{username:"",password:""}}},computed:$({},Object(u["c"])(["loginLoading","user"]),{headerContent:function(){var e=this.$route.meta;return e.title}}),watch:{$route:{deep:!0,immediate:!0,handler:function(e){var t=e.path,n=t.match(/\/[a-z]+/i);console.log("match",n),n&&(this.activeTab=n[0])}}},methods:{goBack:function(){this.$router.back()}},filters:{computedUser:function(e){if(!e)return"";var t=e.split("@");return"欢迎，"+t[0].trim()}}},B=U,M=(n("7c55"),n("2877")),z=Object(M["a"])(B,N,D,!1,null,null,null),F=z.exports,J=n("5a0c"),q=n.n(J);n("a471"),n("c175");function H(){return K.apply(this,arguments)}function K(){return K=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v.dispatch("initStore");case 2:new a["default"]({render:function(e){return e(F)},router:j,store:v}).$mount("#app");case 3:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}q.a.locale("zh-cn"),a["default"].use(o.a),a["default"].config.productionTip=!1,H().then((function(){console.log("start")}))},"5c48":function(e,t,n){},"7c55":function(e,t,n){"use strict";var r=n("5c48"),a=n.n(r);a.a}});
//# sourceMappingURL=app.ddd81fb8.js.map